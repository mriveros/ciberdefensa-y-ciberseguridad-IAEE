-Sistema Operativo:

Device type: specialized|general purpose|storage-misc
Running (JUST GUESSING): Crestron 2-Series (87%), Linux 4.X (85%), HP embedded (85%)
OS CPE: cpe:/o:crestron:2_series cpe:/o:linux:linux_kernel:4.10 cpe:/h:hp:p2000_g3
Aggressive OS guesses: Crestron XPanel control system (87%), Linux 4.10 (85%), HP P2000 G3 NAS device (85%)
No exact OS matches for host (test conditions non-ideal)

- Puertos Abiertos:

PORT     STATE SERVICE  VERSION
80/tcp   open  http     Apache Tomcat/Coyote JSP engine 1.1
443/tcp  open  ssl/http Apache Tomcat/Coyote JSP engine 1.1
8080/tcp open  http     Apache Tomcat/Coyote JSP engine 1.1
8443/tcp open  ssl/http Apache Tomcat/Coyote JSP engine 1.1

- Revision de Certificados:

TLS 1.2
TLS 1.1
TLS 1.0

OBservaciones:
 TLS v1.0 y TLS v1.1 son obsoletos


- Software Obsoleto:

- Los cifrados TLS con la version 1.0 y 1.1 son cofrados obsoletos
- Apache Tomcat/Coyote JSP engine 1.1 esta version de tomcat es vulnerable permitiendo el upload de archivos java con matasploit.



- Vulnerabilidades conocidas (buscar si tienen CVE)

1. http-enum: 
|   /login.jsp: Possible admin folder
|_  /login.jsp: Login page

2. VULNERABLE:
|   Slowloris DOS attack
|     State: LIKELY VULNERABLE
|     IDs:  CVE:CVE-2007-6750

3. ssl-dh-params: 
|   VULNERABLE:
|   Diffie-Hellman Key Exchange Insufficient Group Strength
|     State: VULNERABLE
|       Transport Layer Security (TLS) services that use Diffie

- Directorios conocidos.

Con metasploid se descubrio los directorios

/admin
/bank

-Errores comunes de desarrollo.

1. SQL injection
2. Usuario por defecto admin/admin
3. Cross site scripting nivel medio en http://demo.testfire.net/search.jsp?query=%3C%2Fp%3E%3Cscript%3Ealert%281%29%3B%3C%2Fscript%3E%3Cp%3E
4. Cross site scripting nivel medio en http://demo.testfire.net/sendFeedback
5. Herramientas de desarrollo de Rest Api http://demo.testfire.net/swagger/properties.json

- Errores comunes de certificados.

Los certificados TLS en su version 1.0 y 1.1 son obsoletos, estos certificados deben ser eliminados.
Eliminar el puerto 80 sin puerto seguro o redirigir las peticiones a 8080 que si es un puerto seguro.


- Datos confidenciales o sensibles expuestos.

Datos del usuario administrador cuenta con contrasena por defecto admin/admin, no se debe permitir tener contrasenas iguales al usuario, debe seguir una politica mas estricta.
Documentos expuestos en directorios. Estos documentos no se deben indexar.
Se debe cancelar la indexacion en el servidor web. 

-Fortaleza y debilidades del HB.

1. Una fortaleza es que cuando una peticion no puede ser procesada va a controlador de errores y no muestra informacion del sistema o SO.
2. Una fortaleza es que el dominio no es susceptible a inmiscuir el tipo de SIstema Operativo, probablemente cuente con honeypots.
3. Otra fortaleza es que no estan expuestos los directorios por defecto de gestor de aplicaciones tomcat y no permite acceder al login del mismo y al manager.
4. Una debilidad es que permite la conexion del protocolo ICMP.
5. Anteriormente mencionados los errores de programacion.
6. Anteriormente mencionado mostrar el directorio admin del home banking.

